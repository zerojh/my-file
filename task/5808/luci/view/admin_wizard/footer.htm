
<script language=javascript type="text/javascript" src="<%=resource%>/jquery-1.9.1.min.js"></script>
<script language="javascript" type="text/javascript">
window.onbeforeunload = function() {
	if(is_form_changed()) {
		return "<%:One or more value has been changed, Do you really want to leave without save ?%>";
	}
}
function is_form_changed() {
	var t_save = $(".cbi-button-save");
	if(t_save.length>0) {
		var is_changed = false;
		$("[id^='cbid.']").each(function() {
			var _v = $(this).attr('_value');
			if(typeof(_v) == 'undefined')   _v = '';
			if(_v != $(this).val()) 
				is_changed = true;
		});
		return is_changed;
	}
	return false;
}
$(document).ready(function(){
	$("[id^='cbid.']").each(function() {
		$(this).attr('_value', $(this).val());
	});
	$(".cbi-input-select").each(function(){
		var val = $(this).val()
		if($(this).find('option').length > 1 && val && val.indexOf("addnew_") >= 0)
			$(this).get(0).selectedIndex -= 1
	})
});
function cancel_bind(){window.onbeforeunload=null;}
function save_action(){document.cbi.action=document.cbi.action+"?action=save";cancel_bind();}
function cancel_action(){document.cbi.action=document.cbi.action+"?action=cancel";cancel_bind();}
function select_click(id)
{
}
</script>
<div class="cbi-value cbi-value-last" style="text-align:center;">
<input class="cbi-button" type="submit" name="cbi.cancel" value="后退" onclick="cancel_action();this.form.cbi_state='del-section';return true;"/>
<input class="cbi-button cbi-button-save" type="submit" name="cbi.save" value="继续" onclick="save_action();"/>
<input class="cbi-button" type="reset" value="重置" onclick="cbi_d_update()"/>
<script type="text/javascript">cbi_d_update();</script>
</div>
